!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).mediumZoom=t()}(this,function(){"use strict";var x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},t=function(e){return"IMG"===e.tagName},A=function(e){return e&&1===e.nodeType},k=function(e){return".svg"===(e.currentSrc||e.src).substr(-4).toLowerCase()},S=function(e){try{return Array.isArray(e)?e.filter(t):function(e){return NodeList.prototype.isPrototypeOf(e)}(e)?[].slice.call(e).filter(t):A(e)?[e].filter(t):"string"==typeof e?[].slice.call(document.querySelectorAll(e)).filter(t):[]}catch(e){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}},T=function(e){var t=document.createElement("div");return t.classList.add("medium-zoom-overlay"),t.style.background=e,t},N=function(e){var t=e.getBoundingClientRect(),o=t.top,n=t.left,i=t.width,r=t.height,d=e.cloneNode(),m=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,a=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return d.removeAttribute("id"),d.style.position="absolute",d.style.top=o+m+"px",d.style.left=n+a+"px",d.style.width=i+"px",d.style.height=r+"px",d.style.transform="",d},j=function(e,t){var o=x({bubbles:!1,cancelable:!1,detail:void 0},t);if("function"==typeof window.CustomEvent)return new CustomEvent(e,o);var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,o.bubbles,o.cancelable,o.detail),n};return function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}"),function t(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window.Promise||function(e){function t(){}e(t,t)},i=function(e){var t=e.target;t!==C?-1!==y.indexOf(t)&&g({target:t}):p()},r=function(){if(!E&&H.original){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(w-e)>L.scrollOffset&&setTimeout(p,150)}},d=function(e){var t=e.key||e.keyCode;"Escape"!==t&&"Esc"!==t&&27!==t||p()},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e;if(e.background&&(C.style.background=e.background),e.container&&e.container instanceof Object&&(t.container=x({},L.container,e.container)),e.template){var o=A(e.template)?e.template:document.querySelector(e.template);t.template=o}return L=x({},L,t),y.forEach(function(e){e.dispatchEvent(j("medium-zoom:update",{detail:{zoom:O}}))}),O},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(x({},L,e))},l=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];var i=t.reduce(function(e,t){return[].concat(e,S(t))},[]);return i.filter(function(e){return-1===y.indexOf(e)}).forEach(function(e){y.push(e),e.classList.add("medium-zoom-image")}),b.forEach(function(e){var t=e.type,o=e.listener,n=e.options;i.forEach(function(e){e.addEventListener(t,o,n)})}),O},c=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];H.zoomed&&p();var n=t.length>0?t.reduce(function(e,t){return[].concat(e,S(t))},[]):y;return n.forEach(function(e){e.classList.remove("medium-zoom-image"),e.dispatchEvent(j("medium-zoom:detach",{detail:{zoom:O}}))}),y=y.filter(function(e){return-1===n.indexOf(e)}),O},u=function(t,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return y.forEach(function(e){e.addEventListener("medium-zoom:"+t,o,n)}),b.push({type:"medium-zoom:"+t,listener:o,options:n}),O},s=function(t,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return y.forEach(function(e){e.removeEventListener("medium-zoom:"+t,o,n)}),b=b.filter(function(e){return!(e.type==="medium-zoom:"+t&&e.listener.toString()===o.toString())}),O},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.target,d=function(){var e={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},t=void 0,o=void 0;if(L.container)if(L.container instanceof Object)t=(e=x({},e,L.container)).width-e.left-e.right-2*L.margin,o=e.height-e.top-e.bottom-2*L.margin;else{var n=(A(L.container)?L.container:document.querySelector(L.container)).getBoundingClientRect(),i=n.width,r=n.height,d=n.left,m=n.top;e=x({},e,{width:i,height:r,left:d,top:m})}t=t||e.width-2*L.margin,o=o||e.height-2*L.margin;var a=H.zoomedHd||H.original,l=k(a)?t:a.naturalWidth||t,c=k(a)?o:a.naturalHeight||o,u=a.getBoundingClientRect(),s=u.top,f=u.left,p=u.width,g=u.height,v=Math.min(l,t)/p,h=Math.min(c,o)/g,z=Math.min(v,h),y="scale("+z+") translate3d("+((t-p)/2-f+L.margin+e.left)/z+"px, "+((o-g)/2-s+L.margin+e.top)/z+"px, 0)";H.zoomed.style.transform=y,H.zoomedHd&&(H.zoomedHd.style.transform=y)};return new n(function(t){if(r&&-1===y.indexOf(r))t(O);else{if(H.zoomed)t(O);else{if(r)H.original=r;else{if(!(y.length>0))return void t(O);var e=y;H.original=e[0]}if(H.original.dispatchEvent(j("medium-zoom:open",{detail:{zoom:O}})),w=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,E=!0,H.zoomed=N(H.original),document.body.appendChild(C),L.template){var o=A(L.template)?L.template:document.querySelector(L.template);H.template=document.createElement("div"),H.template.appendChild(o.content.cloneNode(!0)),document.body.appendChild(H.template)}if(document.body.appendChild(H.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),H.original.classList.add("medium-zoom-image--hidden"),H.zoomed.classList.add("medium-zoom-image--opened"),H.zoomed.addEventListener("click",p),H.zoomed.addEventListener("transitionend",function e(){E=!1,H.zoomed.removeEventListener("transitionend",e),H.original.dispatchEvent(j("medium-zoom:opened",{detail:{zoom:O}})),t(O)}),H.original.getAttribute("data-zoom-src")){H.zoomedHd=H.zoomed.cloneNode(),H.zoomedHd.removeAttribute("srcset"),H.zoomedHd.removeAttribute("sizes"),H.zoomedHd.src=H.zoomed.getAttribute("data-zoom-src"),H.zoomedHd.onerror=function(){clearInterval(n),console.warn("Unable to reach the zoom image target "+H.zoomedHd.src),H.zoomedHd=null,d()};var n=setInterval(function(){H.zoomedHd.complete&&(clearInterval(n),H.zoomedHd.classList.add("medium-zoom-image--opened"),H.zoomedHd.addEventListener("click",p),document.body.appendChild(H.zoomedHd),d())},10)}else if(H.original.hasAttribute("srcset")){H.zoomedHd=H.zoomed.cloneNode(),H.zoomedHd.removeAttribute("sizes"),H.zoomedHd.removeAttribute("loading");var i=H.zoomedHd.addEventListener("load",function(){H.zoomedHd.removeEventListener("load",i),H.zoomedHd.classList.add("medium-zoom-image--opened"),H.zoomedHd.addEventListener("click",p),document.body.appendChild(H.zoomedHd),d()})}else d()}}})},p=function(){return new n(function(t){if(!E&&H.original){E=!0,document.body.classList.remove("medium-zoom--opened"),H.zoomed.style.transform="",H.zoomedHd&&(H.zoomedHd.style.transform=""),H.template&&(H.template.style.transition="opacity 150ms",H.template.style.opacity=0),H.original.dispatchEvent(j("medium-zoom:close",{detail:{zoom:O}})),H.zoomed.addEventListener("transitionend",function e(){H.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(H.zoomed),H.zoomedHd&&document.body.removeChild(H.zoomedHd),document.body.removeChild(C),H.zoomed.classList.remove("medium-zoom-image--opened"),H.template&&document.body.removeChild(H.template),E=!1,H.zoomed.removeEventListener("transitionend",e),H.original.dispatchEvent(j("medium-zoom:closed",{detail:{zoom:O}})),H.original=null,H.zoomed=null,H.zoomedHd=null,H.template=null,t(O)})}else t(O)})},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.target;return H.original?p():f({target:t})},v=function(){return L},h=function(){return y},z=function(){return H.original},y=[],b=[],E=!1,w=0,L=o,H={original:null,zoomed:null,zoomedHd:null,template:null};"[object Object]"===Object.prototype.toString.call(e)?L=e:(e||"string"==typeof e)&&l(e),L=x({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},L);var C=T(L.background);document.addEventListener("click",i),document.addEventListener("keyup",d),document.addEventListener("scroll",r),window.addEventListener("resize",p);var O={open:f,close:p,toggle:g,update:m,clone:a,attach:l,detach:c,on:u,off:s,getOptions:v,getImages:h,getZoomedImage:z};return O}});